<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Store</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav class="navbar">
      <h1 class="nav-title">Product Store</h1>
      <input
        type="text"
        id="search"
        placeholder="Search by name or category..."
        class="search-box"
      />
      <button id="darkModeToggle" class="dark-mode-toggle">ðŸŒ™</button>
    </nav>

    <div class="container">
      <div id="product-grid" class="grid"></div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        fetch("data/products.json")
          .then((response) => response.json())
          .then((data) => {
            displayProducts(data.products);
          })
          .catch((error) => console.error("Error fetching products:", error));

        document.getElementById("search").addEventListener("input", () => {
          fetch("data/products.json")
            .then((response) => response.json())
            .then((data) => displayProducts(data.products));
        });

        const darkModeToggle = document.getElementById("darkModeToggle");
        const prefersDarkScheme = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;

        if (
          localStorage.getItem("darkMode") === "enabled" ||
          (!localStorage.getItem("darkMode") && prefersDarkScheme)
        ) {
          document.body.classList.add("dark-mode");
        }

        darkModeToggle.addEventListener("click", toggleDarkMode);
      });

      function displayProducts(products, search = "") {
        const productGrid = document.getElementById("product-grid");
        productGrid.innerHTML = "";

        const filteredProducts = products.filter(
          (product) =>
            product.name.toLowerCase().includes(search.toLowerCase()) ||
            product.category.toLowerCase().includes(search.toLowerCase())
        );

        filteredProducts.forEach((product) => {
          const productCard = document.createElement("div");
          productCard.className = "product-card";
          productCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <h2 class="product-title">${product.name}</h2>
                    <p class="product-category">${product.category}</p>
                    <p class="product-price">$${product.price}</p>
                    <p class="product-description">${product.description}</p>
                `;
          productGrid.appendChild(productCard);
        });
      }

      function toggleDarkMode() {
        document.body.classList.toggle("dark-mode");
        if (document.body.classList.contains("dark-mode")) {
          localStorage.setItem("darkMode", "enabled");
        } else {
          localStorage.setItem("darkMode", "disabled");
        }
      }
    </script>

    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        text-align: center;
        background: linear-gradient(to right, #ff7e5f, #feb47b);
        color: #333;
        transition:
          background 0.3s,
          color 0.3s;
      }
      .dark-mode {
        background: #222;
        color: #fff;
      }
      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 20px;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
      }
      .dark-mode .navbar {
        background: rgba(50, 50, 50, 0.8);
      }
      .nav-title {
        font-size: 2em;
        font-weight: bold;
      }
      .search-box {
        padding: 10px;
        width: 300px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 1em;
      }
      .dark-mode .search-box {
        background: #444;
        color: white;
        border: 1px solid #888;
      }
      .dark-mode-toggle {
        padding: 10px;
        border: none;
        background: #333;
        color: white;
        border-radius: 5px;
        cursor: pointer;
      }
      .dark-mode .dark-mode-toggle {
        background: #fff;
        color: #333;
      }
      .container {
        max-width: 1200px;
        margin: 20px auto;
        padding: 20px;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
      }
      .product-card {
        border: none;
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
        background: #fff;
      }
      .dark-mode .product-card {
        background: #333;
        color: white;
      }
    </style>
  </body>
</html>
